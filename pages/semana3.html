<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Semana 3: Ejecuci√≥n del Plan de Pruebas</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="../assets/css/style.css" rel="stylesheet">

    <style>
        .sidebar-nav-custom .nav-link {
            font-weight: 500;
            margin-bottom: 0.5rem;
            transition: all 0.2s ease-in-out;
            background-color: var(--it-white);
            color: var(--it-black);
            border: 1px solid var(--it-gray-medium);
            text-align: center;
            padding: 0.75rem 1.25rem;
        }
        .sidebar-nav-custom .nav-link:hover {
            background-color: var(--it-blue-main);
            color: var(--it-white);
            border-color: var(--it-blue-main);
        }
        .sidebar-nav-custom .nav-link.active {
             background-color: var(--it-blue-main);
            color: var(--it-white);
            border-color: var(--it-blue-main);
            font-weight: 700;
        }
        .sidebar-nav-custom.sticky-top {
            top: 80px;
        }

        .evidence-thumbnail {
            width: 150px; 
            height: auto;
            border: 1px solid var(--it-gray-medium);
            border-radius: 5px;
            cursor: pointer; 
            transition: transform 0.2s;
        }
        .evidence-thumbnail:hover {
            transform: scale(1.02);
        }
        
        .accordion-button.evidence-success {
            background-color: #d1e7dd; 
            color: #0f5132;
        }
        .accordion-button.evidence-failure {
            background-color: #f8d7da; 
            color: #842029;
        }

    </style>
</head>
<body>

<div id="main-container">
    <nav class="navbar navbar-expand-lg border-bottom sticky-top">
        <div class="container-fluid">
            <button class="btn btn-menu me-3" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" aria-controls="offcanvasSidebar">
                <i class="fas fa-bars me-2"></i>Men√∫
            </button>
            <a class="navbar-brand" href="../index.html">Programa Eureka | QA</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="ref.html">Bibliograf√≠a</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="offcanvas offcanvas-start bg-dark-blue" tabindex="-1" id="offcanvasSidebar" aria-labelledby="offcanvasSidebarLabel">
        <div class="offcanvas-header">
            <h5 class="offcanvas-title text-white" id="offcanvasSidebarLabel">Navegaci√≥n</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
        </div>
        <div class="offcanvas-body">
            <div class="list-group list-group-flush">
                <a href="semana2.html" class="list-group-item list-group-item-action bg-dark-blue text-white"><i class="fas fa-clipboard-list me-2"></i><span>Semana 2: Plan de Pruebas</span></a>
                <a href="semana3.html" class="list-group-item list-group-item-action bg-dark-blue text-white active"><i class="fas fa-chart-bar me-2"></i><span>Semana 3: Evidencias</span></a>
            </div>
        </div>
    </div>
    <main class="container py-5">
        <div class="row g-4 g-lg-5">
            
            <div class="col-lg-3">
                <nav class="nav flex-column sidebar-nav-custom sticky-top">
                    <h5 class="fw-bold mt-2 mb-3 text-muted">Contenido de la Semana</h5>
                    <a class="nav-link active" href="#introduccion-resultados">
                        Introducci√≥n y Resumen
                    </a>
                    <a class="nav-link" href="#api-solicitudes">
                        Evidencias API Solicitudes
                    </a>
                    <a class="nav-link" href="#defectos-reportados">
                        Defectos Reportados
                    </a>
                    <a class="nav-link" href="#conclusiones">
                        Conclusiones y Recom.
                    </a>
                </nav>
            </div>

            <div class="col-lg-9">
                <header class="mb-5" id="main-content-header">
                    <h1 class="display-5 fw-bold text-center">Semana 3: Ejecuci√≥n y Resultados del Plan de Pruebas</h1>
                    <p class="lead fs-5 text-center text-muted">Evidencias de la ejecuci√≥n de los casos de prueba definidos para las APIs.</p>
                </header>
                
                <section class="content-section" id="introduccion-resultados">
                    <h2 class="section-title"><i class="fas fa-chart-line me-2"></i>1. Introducci√≥n y Resumen</h2>
                    <p>La ejecuci√≥n se realiz√≥ conforme al Plan de Pruebas de la Semana 2. Se detalla el resultado de los casos de prueba, agrupados por funcionalidad. Los detalles de cada evidencia son desplegables para su revisi√≥n.</p>
                </section>
                
                <hr class="my-4">

                <section class="content-section" id="api-solicitudes">
                    <h2 class="section-title"><i class="fas fa-clipboard-check me-2"></i>2. Evidencias ‚Äì API de Solicitudes</h2>
                    
                    <div class="accordion" id="accordionEvidencias">

                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingS01">
                                <button class="accordion-button evidence-success collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseS01" aria-expanded="false" aria-controls="collapseS01">
                                    <span class="flex-grow-1 text-start">TC-S01: Crear una solicitud (POST) - ‚úÖ √âxito</span>
                                </button>
                            </h2>
                            <div id="collapseS01" class="accordion-collapse collapse" aria-labelledby="headingS01" data-bs-parent="#accordionEvidencias">
                                <div class="accordion-body">
                                    <div class="d-flex align-items-start justify-content-between gap-3">
                                        <div class="flex-grow-1">
                                            <p><strong>Descripci√≥n:</strong> Prueba de creaci√≥n de un nuevo recurso de solicitud con datos v√°lidos.</p>
                                            <p><strong>Resultado Esperado:</strong> C√≥digo <code>201 Created</code>.</p>
                                            <p><strong>Resultado Actual:</strong> √âxito. El cuerpo de la respuesta incluye el ID de la nueva solicitud.</p>
                                            <p class="small text-muted mb-0">Haga clic en la imagen para verla en tama√±o completo.</p>
                                        </div>
                                        <div>
                                            <img src="../assets/img/semana3/01_post_crear_solicitud.png" 
                                                 class="evidence-thumbnail" 
                                                 alt="Evidencia TC-S01"
                                                 data-bs-toggle="modal" 
                                                 data-bs-target="#imageModal"
                                                 data-image-src="../assets/img/semana3/01_post_crear_solicitud.png"
                                                 data-image-title="Evidencia TC-S01: POST /solicitudes">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingS05">
                                <button class="accordion-button evidence-failure collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseS05" aria-expanded="false" aria-controls="collapseS05">
                                    <span class="flex-grow-1 text-start">TC-S05: Validar l√≥gica de negocio (Renta) - üî¥ FALLIDO</span>
                                </button>
                            </h2>
                            <div id="collapseS05" class="accordion-collapse collapse" aria-labelledby="headingS05" data-bs-parent="#accordionEvidencias">
                                <div class="accordion-body">
                                    <div class="d-flex align-items-start justify-content-between gap-3">
                                        <div class="flex-grow-1">
                                            <p><strong>Descripci√≥n:</strong> Intento de crear solicitud donde <code>rentaDesde</code> ($1000) es mayor que <code>rentaHasta</code> ($800).</p>
                                            <p><strong>Resultado Esperado:</strong> C√≥digo <code>400 Bad Request</code> (Error de L√≥gica de Negocio).</p>
                                            <p><strong>Resultado Actual:</strong> üî¥ **FALLO**. La API retorn√≥ <code>201 Created</code>, permitiendo datos inconsistentes. (Ver <a href="#defecto-d001">Defecto D-001</a>)</p>
                                            <p class="small text-muted mb-0">Haga clic en la imagen para verla en tama√±o completo.</p>
                                        </div>
                                        <div>
                                            <img src="../assets/img/semana3/05_post_cambio_renta.png" 
                                                 class="evidence-thumbnail" 
                                                 alt="Evidencia TC-S05"
                                                 data-bs-toggle="modal" 
                                                 data-bs-target="#imageModal"
                                                 data-image-src="../assets/img/semana3/05_post_cambio_renta.png"
                                                 data-image-title="Evidencia TC-S05: Falla de L√≥gica de Renta">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingS02">
                                <button class="accordion-button evidence-success collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseS02" aria-expanded="false" aria-controls="collapseS02">
                                    <span class="flex-grow-1 text-start">TC-S02: Obtener solicitud por ID (GET) - ‚úÖ √âxito</span>
                                </button>
                            </h2>
                            <div id="collapseS02" class="accordion-collapse collapse" aria-labelledby="headingS02" data-bs-parent="#accordionEvidencias">
                                <div class="accordion-body">
                                    <div class="d-flex align-items-start justify-content-between gap-3">
                                        <div class="flex-grow-1">
                                            <p><strong>Descripci√≥n:</strong> Recuperar los detalles de una solicitud espec√≠fica.</p>
                                            <p><strong>Resultado Esperado:</strong> C√≥digo <code>200 OK</code> con el objeto de solicitud.</p>
                                            <p><strong>Resultado Actual:</strong> √âxito. Datos correctos retornados.</p>
                                            <p class="small text-muted mb-0">Haga clic en la imagen para verla en tama√±o completo.</p>
                                        </div>
                                        <div>
                                            <img src="../assets/img/semana3/02_get_ver_solicitud.png" 
                                                 class="evidence-thumbnail" 
                                                 alt="Evidencia TC-S02"
                                                 data-bs-toggle="modal" 
                                                 data-bs-target="#imageModal"
                                                 data-image-src="../assets/img/semana3/02_get_ver_solicitud.png"
                                                 data-image-title="Evidencia TC-S02: GET /solicitudes/{id}">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="accordion-item">
                            <h2 class="accordion-header" id="headingE02">
                                <button class="accordion-button evidence-failure collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseE02" aria-expanded="false" aria-controls="collapseE02">
                                    <span class="flex-grow-1 text-start">TC-E02: Verificar persistencia de datos (POST) - üî¥ FALLIDO</span>
                                </button>
                            </h2>
                            <div id="collapseE02" class="accordion-collapse collapse" aria-labelledby="headingE02" data-bs-parent="#accordionEvidencias">
                                <div class="accordion-body">
                                    <div class="d-flex align-items-start justify-content-between gap-3">
                                        <div class="flex-grow-1">
                                            <p><strong>Descripci√≥n:</strong> Prueba de resiliencia del servicio; validar que al reiniciar el contenedor Docker los datos persistan sin errores.</p>
                                            <p><strong>Resultado Esperado:</strong> Servicio reinicia con √©xito.</p>
                                            <p><strong>Resultado Actual:</strong> üî¥ **FALLO**. El servicio arroja error fatal por clave duplicada al intentar reinicializar la DB. (Ver <a href="#defecto-d002">Defecto D-002</a>)</p>
                                            <p class="small text-muted mb-0">Haga clic en la imagen para verla en tama√±o completo.</p>
                                        </div>
                                        <div>
                                            <img src="../assets/img/semana3/10_gustavo_especificaciones_post.png" 
                                                 class="evidence-thumbnail" 
                                                 alt="Evidencia TC-E02 - Error en Logs"
                                                 data-bs-toggle="modal" 
                                                 data-bs-target="#imageModal"
                                                 data-image-src="../assets/img/semana3/10_gustavo_especificaciones_post.png"
                                                 data-image-title="Evidencia TC-E02: Error de Persistencia (Log)">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>


                    </div>
                </section>
                
                <hr class="my-4">

                <section class="content-section" id="defectos-reportados">
                    <h2 class="section-title"><i class="fas fa-bug me-2"></i>3. Defectos Reportados</h2>

                    <div class="mb-4" id="defecto-d001">
                        <h3 class="h5 fw-bold text-danger">Reporte de Defecto: D-001 (API Solicitudes)</h3>
                        <div class="content-card">
                            <h4 class="card-title-custom">T√≠tulo: Incoherencia en la validaci√≥n del rango de renta.</h4>
                            <p><strong>Severidad / Prioridad:</strong> <span class="badge bg-danger">Severidad: Mayor</span> <span class="badge bg-warning text-dark">Prioridad: Alta</span></p>
                            <p><strong>Descripci√≥n:</strong> La API permite registrar una solicitud donde el valor de 'rentaDesde' es mayor que 'rentaHasta'.</p>
                            <p><strong>Pasos para Reproducir:</strong> Enviar POST a <code>/solicitudes</code> con rentaDesde=1000 y rentaHasta=800.</p>
                        </div>
                    </div>

                    <div id="defecto-d002">
                        <h3 class="h5 fw-bold text-danger">Reporte de Defecto: D-002 (API Ofertas)</h3>
                        <div class="content-card">
                            <h4 class="card-title-custom">T√≠tulo: Falla de idempotencia en script de inicializaci√≥n de datos.</h4>
                            <p><strong>Severidad / Prioridad:</strong> <span class="badge bg-danger">Severidad: Cr√≠tica</span> <span class="badge bg-warning text-dark">Prioridad: Alta</span></p>
                            <p><strong>Descripci√≥n:</strong> El script de inserci√≥n de datos iniciales causa errores de clave primaria duplicada al reiniciar el contenedor Docker.</p>
                            <p><strong>Recomendaci√≥n:</strong> Usar **INSERT ... ON CONFLICT DO NOTHING** en el script de inicializaci√≥n.</p>
                        </div>
                    </div>
                </section>
                
                <hr class="my-4">

                <section class="content-section" id="conclusiones">
                    <h2 class="section-title"><i class="fas fa-lightbulb me-2"></i>4. Hallazgos y Recomendaciones</h2>
                    <ol class="mt-4">
                        <li><strong>Unificar Contrato de Errores:</strong> Estandarizar las respuestas de error en un formato JSON consistente.</li>
                        <li><strong>Validaciones de L√≥gica de Negocio:</strong> Implementar validaciones para Defecto D-001.</li>
                        <li><strong>Paginaci√≥n en Listados:</strong> Implementar paginaci√≥n en endpoints de listado para rendimiento.</li>
                        <li><strong>Manejo de Datos en Contenedores:</strong> Solucionar la falta de idempotencia (Defecto D-002).</li>
                    </ol>
                </section>
                
            </div>
            </div>
    </main>

    <div class="modal fade" id="imageModal" tabindex="-1" aria-labelledby="imageModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="imageModalLabel">Vista de Evidencia</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body text-center">
            <img src="" class="img-fluid" id="modalImage" alt="Evidencia Agrandada">
          </div>
        </div>
      </div>
    </div>

    <footer class="py-3 mt-5">
        <div class="container text-center">
            <small class="text-white">&copy; 2025 ‚Ä¢ Programa Eureka ‚Ä¢ QA</small>
        </div>
    </footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const imageModal = document.getElementById('imageModal');
        imageModal.addEventListener('show.bs.modal', function (event) {
            const button = event.relatedTarget; 
            const imageSrc = button.getAttribute('data-image-src');
            const imageTitle = button.getAttribute('data-image-title');
            
            const modalImage = imageModal.querySelector('#modalImage');
            const modalTitle = imageModal.querySelector('.modal-title');
            
            modalImage.src = imageSrc;
            modalTitle.textContent = imageTitle;
        });
    });
</script>

</body>
</html>